var CaaSAc;(()=>{"use strict";var e={d:(a,s)=>{for(var t in s)e.o(s,t)&&!e.o(a,t)&&Object.defineProperty(a,t,{enumerable:!0,get:s[t]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},a={};e.r(a),e.d(a,{CaasAcc:()=>s});class s{constructor(e){this.currentUser=null,this.currentProject=null,this.currentHub=null,this.demoMode=!1,this.useDirectFetch=!1,this.useStreaming=!0,this.serveraddress=e}async getConfiguration(){var e=await fetch(this.serveraddress+"/caas_ac_api/configuration"),a=await e.json();this.useDirectFetch=a.useDirectFetch,this.useStreaming=a.useStreaming,this.demoMode=a.demoMode}async checkLogin(){await this.getConfiguration();var e=await fetch(this.serveraddress+"/caas_ac_api/checklogin"),a=await e.json();a.succeeded&&(this.currentUser=a.user,a.hub?a.project?(this.currentHub=a.hub,this.currentProject=a.project):(this.currentHub=a.hub,this.currentProject=null):(this.currentProject=null,this.currentHub=null))}async logout(){await fetch(this.serveraddress+"/caas_ac_api/logout/",{method:"PUT"})}register(e){var a=new FormData;return a.append("firstName",e.firstName),a.append("lastName",e.lastName),a.append("email",e.email),a.append("password",e.password),new Promise((function(e,s){$.ajax({url:this.serveraddress+"/api/register",type:"post",data:a,contentType:!1,processData:!1,success:function(a){a.ERROR?e(a.ERROR):e("SUCCESS")}})}))}login(e,a){var s=new FormData;s.append("email",e),s.append("password",a);var t=this;return new Promise((function(e,a){$.ajax({url:this.serveraddress+"/api/login",type:"post",data:s,contentType:!1,processData:!1,success:function(a){a.ERROR?e(a.ERROR):(t.currentUser=a.user,e(a))}})}))}async leaveHub(){await fetch(this.serveraddress+"/caas_ac_api/hub/none",{method:"PUT"}),this.currentProject=null,this.currentHub=null}async getHubs(){var e=await fetch(this.serveraddress+"/caas_ac_api/hubs");return await e.json()}async renameHub(e,a){await fetch(this.serveraddress+"/caas_ac_api/renameHub/"+e+"/"+a,{method:"PUT"})}async createHUB(e){let a=await fetch(this.serveraddress+"/caas_ac_api/newhub/"+e,{method:"PUT"});return await a.json()}async loadHub(e){let a=await fetch(this.serveraddress+"/caas_ac_api/hub/"+e,{method:"PUT"}),s=await a.json();this.currentHub=s}async getHUBUsers(e){let a=await fetch(this.serveraddress+"/caas_ac_api/hubusers/"+e);return await a.json()}async addHUBUser(e,a,s){await fetch(this.serveraddress+"/caas_ac_api/addHubUser/"+e+"/"+a+"/"+s,{method:"PUT"})}async updateHUBUser(e,a,s){await fetch(this.serveraddress+"/caas_ac_api/updateHubUser/"+e+"/"+a+"/"+s,{method:"PUT"})}async deleteUserFromHUB(e,a){await fetch(this.serveraddress+"/caas_ac_api/deleteHubUser/"+e+"/"+a,{method:"PUT"})}async deleteHUB(e){await fetch(this.serveraddress+"/caas_ac_api/deleteHub/"+e,{method:"PUT"})}async acceptHUB(e,a){await fetch(this.serveraddress+"/caas_ac_api/acceptHub/"+e+"/"+a,{method:"PUT"}),this.refreshHubTable()}async leaveProject(){await fetch(this.serveraddress+"/caas_ac_api/project/none",{method:"PUT"}),this.currentProject=null}async renameProject(e,a){await fetch(this.serveraddress+"/caas_ac_api/renameproject/"+e+"/"+a,{method:"PUT"})}async createProject(e){let a=await fetch(this.serveraddress+"/caas_ac_api/newproject/"+e,{method:"PUT"});return await a.json()}async deleteProject(e){await fetch(this.serveraddress+"/caas_ac_api/deleteproject/"+e,{method:"PUT"})}async loadProject(e){await fetch(this.serveraddress+"/caas_ac_api/project/"+e,{method:"PUT"}),this.currentProject=data.projectname}async getProjects(){let e=await fetch(this.serveraddress+"/caas_ac_api/projects");return await e.json()}async getProjectUsers(e){let a=await fetch(this.serveraddress+"/caas_ac_api/projectusers/"+e);return await a.json()}async addProjectUser(e,a,s){await fetch(this.serveraddress+"/caas_ac_api/addProjectUser/"+e+"/"+a+"/"+s,{method:"PUT"})}async editProjectUser(e,a,s){await fetch(this.serveraddress+"/caas_ac_api/updateProjectUser/"+e+"/"+a+"/"+s,{method:"PUT"})}async deleteUserFromProject(e,a){await fetch(this.serveraddress+"/caas_ac_api/deleteProjectUser/"+e+"/"+a,{method:"PUT"})}async getUploadToken(e,a){let s=await fetch(this.serveraddress+"/caas_ac_api/uploadToken/"+e+"/"+a);return await s.json()}processUploadFromToken(e,a){fetch(this.serveraddress+"/caas_ac_api/processToken/"+e,{method:"PUT",headers:{startpath:a}})}async getModels(){let e=await fetch(this.serveraddress+"/caas_ac_api/models");return await e.json()}async getDownloadToken(e,a){let s=await fetch(this.serveraddress+"/caas_ac_api/downloadToken/"+e+"/"+a);return await s.json()}async getPNG(e){return await fetch(this.serveraddress+"/caas_ac_api/png/"+e)}async getSCS(e){let a=await fetch(this.serveraddress+"/caas_ac_api/scs/"+e),s=await a.arrayBuffer();return new Uint8Array(s)}async enableStreamAccess(e){await fetch(this.serveraddress+"/caas_ac_api/enableStreamAccess/"+e,{method:"PUT"})}async deleteModel(e){await fetch(this.serveraddress+"/caas_ac_api/deleteModel/"+e,{method:"PUT"})}async initializeWebviewer(e){let a;if(myAdmin.useStreaming){let t=await fetch(serveraddress+"/caas_ac_api/streamingSession");var s=await t.json();a=new Communicator.WebViewer({containerId:e,endpointUri:"ws://"+s.serverurl+":"+s.port+"?token="+s.sessionid,model:"_empty",rendererType:Communicator.RendererType.Client})}else a=new Communicator.WebViewer({containerId:e,empty:!0,streamingMode:1});return a}}CaaSAc=a})();